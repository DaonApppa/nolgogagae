<!DOCTYPE html>
<html>
<head>
    <title>놀고가게 신청표</title>
    <meta charset="UTF-8"> <!-- 인코딩을 UTF-8로 지정합니다. -->
    <style>
        body {
            font-size: 14px; /* 기본 글자 크기를 14px로 지정합니다. */
        }

        table {
            border-collapse: collapse;
            width: 100%;
            font-family: Arial, sans-serif; /* 폰트 설정을 추가합니다. */
        }

        th, td {
            border: 1px solid black;
            padding: 8px;
            text-align: center;
        }

        th {
            background-color: #f2f2f2;
        }

        tr:hover {
            background-color: #f5f5f5;
        }
    </style>
</head>
<body>
    <h2>놀고가게 신청표</h2>
    <table id="timetable">
        <tr>
            <th>시간</th>
            <!-- 각 시간대마다 8명의 입력 셀을 추가합니다. -->
            <th>이름1</th>
            <th>이름2</th>
            <th>이름3</th>
            <th>이름4</th>
            <th>이름5</th>
            <th>이름6</th>
            <th>이름7</th>
            <th>이름8</th>
        </tr>
        <!-- 시간대 행을 9시부터 24시까지 1시간 간격으로 반복하여 추가합니다. -->
        <!-- 시간표 행 생성 함수 -->
        <script>
            function createTimetable() {
                const table = document.getElementById('timetable');
                for (let i = 9; i <= 24; i++) {
                    const newRow = table.insertRow();
                    const timeCell = newRow.insertCell();
                    timeCell.innerText = `${i}:00 - ${i + 1}:00`;

                    // 8개의 이름 입력 셀을 추가합니다.
                    for (let j = 0; j < 8; j++) {
                        const nameCell = newRow.insertCell();
                        nameCell.contentEditable = "true";
                        nameCell.innerText = ""; // 초기값은 비워둡니다.
                    }
                }
            }
        </script>
    </table>

    <!-- 초기화 버튼을 추가합니다. -->
    <button onclick="promptPassword()">초기화</button>

    <!-- 페이지가 로드되면 시간표를 생성하고, 저장된 데이터를 불러옵니다. -->
    <script>
        window.addEventListener('load', function() {
            createTimetable();
            loadTimetableFromStorage();
        });

        // 데이터를 로컬 스토리지에 저장하는 함수
        function saveTimetableToStorage() {
            const timetableData = [];
            const table = document.getElementById('timetable');

            // 데이터를 테이블에서 추출합니다.
            for (let i = 1; i < table.rows.length; i++) {
                const row = table.rows[i];
                const time = row.cells[0].innerText;
                const names = [];

                // 각 시간대 행에 있는 이름을 추출합니다.
                for (let j = 1; j < row.cells.length; j++) {
                    const name = row.cells[j].innerText.trim();
                    names.push(name);
                }

                timetableData.push({ time, names });
            }

            // 추출한 데이터를 로컬 스토리지에 저장합니다.
            localStorage.setItem('timetable', JSON.stringify(timetableData));
        }

        // 로컬 스토리지로부터 데이터를 불러와서 테이블에 표시하는 함수
        function loadTimetableFromStorage() {
            const savedData = localStorage.getItem('timetable');

            if (savedData) {
                const timetableData = JSON.parse(savedData);
                const table = document.getElementById('timetable');

                // 기존 행 삭제
                while (table.rows.length > 1) {
                    table.deleteRow(1);
                }

                // 로컬 스토리지에서 불러온 데이터로 테이블을 채웁니다.
                timetableData.forEach((data) => {
                    const newRow = table.insertRow();
                    const timeCell = newRow.insertCell();
                    timeCell.innerText = data.time;

                    // 각 시간대에 이름을 채웁니다.
                    for (let i = 0; i < 8; i++) {
                        const nameCell = newRow.insertCell();
                        nameCell.contentEditable = "true";
                        nameCell.innerText = data.names[i] || ""; // 빈 값을 처리합니다.
                    }
                });
            }
        }

        // 초기화 버튼 클릭 시 비밀번호 확인을 받는 함수
        function promptPassword() {
            const inputPassword = prompt("비밀번호를 입력하세요.");

            if (inputPassword === "0831") {
                // 비밀번호가 일치하면 시간표를 초기화합니다.
                clearTimetable();
            } else {
                alert("비밀번호가 올바르지 않습니다. 초기화할 수 없습니다.");
            }
        }

        // 초기화 버튼 클릭 시 시간표를 초기화하는 함수
        function clearTimetable() {
            const table = document.getElementById('timetable');

            // 기존 행 삭제
            while (table.rows.length > 1) {
                table.deleteRow(1);
            }

            // 새로운 시간표 생성
            createTimetable();

            // 로컬 스토리지 초기화
            localStorage.removeItem('timetable');
        }

        // 사용자가 테이블 내용을 편집할 때마다 저장 함수를 호출합니다.
        const table = document.getElementById('timetable');
        table.addEventListener('input', function() {
            saveTimetableToStorage();
        });
    </script>
</body>
</html>
